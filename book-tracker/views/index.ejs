<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Book Tracker</title>
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <h1>My Book List</h1>
    <a href="/books/add">+ Add a new book</a>
    <form method="GET" action="/books" style="margin-bottom: 1rem;">
      <label for="sort">Sort by:</label>
      <select name="sort" id="sort" onchange="this.form.submit()">
        <option value="">-- Choose --</option>
        <option value="rating" <%= sort === 'rating' ? 'selected' : ''%>>Rating (high to low)</option>
        <option value="date" <%= sort === 'date' ? 'selected' : '' %>>Recency (latest first)</option>
      </select>
    </form>

    <ul>
      <% if (books.length === 0) { %>
      <li>No books found.</li>
      <% } else { %> <% books.forEach(book => { %>
      <li>
        <div>
          <h3><%= book.title %></h3>
          <p>Author: <%= book.author %></p>
          <p>Rating: <%= book.rating %> â˜…</p>
          <p>
            Read:<% const options = { weekday: 'short', year: 'numeric', month:
            'short', day: 'numeric' }; %> <%= new
            Date(book.date_read).toLocaleDateString('en-US', options) %>
          </p>
          <p>Review: <%= book.review %></p>

          <% if (book.cover_url) { %>
          <img src="<%= book.cover_url %>" alt="cover" height="200" />
          <% } %>

          <form
            method="GET"
            action="/books/<%= book.id %>/edit"
            style="display: inline"
          >
            <button type="submit">Edit</button>
          </form>

          <form
            method="POST"
            action="/books/<%= book.id %>/delete"
            style="display: inline"
          >
            <button type="submit" onclick="return confirm('Are you sure?')">
              Delete
            </button>
          </form>
        </div>
      </li>
      <% }); %> <% } %>
    </ul>
  </body>
</html>
